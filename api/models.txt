model CartItem {
    id Int @id @default(autoincrement())
    cart Cart @relation(fields: [cartId], references: [id], onDelete: Cascade)
    cartId Int
    product Product @relation(fields: [productId], references: [id], onDelete: Cascade)
    productId Int
    quantity Int

    @@schema("public")
}model Cart {
    id Int @id @default(autoincrement())
    
    owner User @relation(fields: [ownerId], references: [id], onDelete: Cascade)
    ownerId String
    cartItems CartItem[]

    @@schema("public")
}enum InventoryStatus {
    Available
    Low_On_stock
    Not_Available
    For_Delivery

    @@schema("inventory")
}model Inventory {
    id      Int     @id @default(autoincrement())
    name    String  @ecart.VarChar(50)
    quantity Int
    status InventoryStatus @default(Available)
    
    product Product @relation(fields: [productId], references: [id], onDelete: Cascade)
    productId Int @unique

    @@schema("inventory")
}enum OrderStatus {
    Confirming_Order
    Preparing
    Ready_For_Pickup
    For_Delivery
    Done
    Cancelled

    @@schema("orders")
}model Orders {
    id Int @id @default(autoincrement())
    payment PaymentMethod @default(Cash)
    
    cart    Cart    @relation(fields: [cartId], references: [id], onDelete: Cascade)
    cartId Int

    checkoutTime    DateTime   @default(now())
    status OrderStatus

    @@schema("orders")
}   enum PaymentMethod {
    Cash
    E_Wallet
    Debit_Or_Credit

    @@schema("orders")
}model Product {
    id      Int     @id @default(autoincrement())
    name    String  @ecart.VarChar(50)
    size Sizes
    price Int
    cartItems CartItem[]
    inventory Inventory?

    @@schema("public")
}enum Providers {
    Local
    Facebook
    Gmail

    @@schema("auth")
}enum Role {
    Member
    Guest
    Admin

    @@schema("auth")
}model Session {
    id      String      @id 
    sid     String      @unique
    data    String
    expiresAt   DateTime

    @@schema("auth")
}enum Sizes {
    Small
    Medium
    Large
    Solo
    For_Share

    @@schema("inventory")
}model UserCredentials {
    id  String @id @default(uuid())
    provider Providers
    providerId String //unique id from facebook/google
    passwordHash    String @ecart.VarChar(72) //make null if provider is not local
    //accessToken String? //future use
    //futureTokenn String? //future use

    user User @relation(fields: [userId], references: [id], onDelete: Cascade)
    userId String

    @@unique([provider, providerId])

    @@schema("auth")
}model UserProfile {
    firstName   String  @ecart.VarChar(50)
    lastName    String  @ecart.VarChar(100)
    username    String? @unique @ecart.VarChar(30)

    user User @relation(fields: [userId], references: [id], onDelete: Cascade)
    userId String
    
    @@id([firstName, lastName])

    @@schema("auth")
}model User {
    id          String     @id @default(uuid())
    email       String @unique @ecart.VarChar(254)
    role        Role @default(Member)
    created_at  DateTime @default(now())
    credentials UserCredentials[]

    @@schema("auth")
}